<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Groq Video Transcriber</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>

<body>
  <div class="transcriber-wrapper">
    <nav class="navbar navbar-dark bg-transparent">
      <div class="container">
        <a class="navbar-brand fw-semibold" href="{{ url_for('index') }}">Groq Transcriber</a>
      </div>
    </nav>

    <main class="container py-5">
      {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
      <div class="col-lg-10 col-xl-8 mx-auto mb-4">
        {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
        {% endfor %}
      </div>
      {% endif %}
      {% endwith %}

      <div class="card shadow-lg border-0 glass-card">
        <div class="card-body p-4 p-md-5">
          <h1 class="card-title display-6 fw-semibold mb-3 text-white">Transcribe YouTube in Seconds</h1>
          <p class="text-white-50 mb-4">Paste any YouTube URL. We’ll download the audio, convert it with
            ffmpeg, send it to Groq Whisper, and stream the text back here.</p>

          <form method="POST" action="{{ url_for('transcribe_route') }}" class="row g-3">
            <div class="col-12">
              <label for="video_url" class="form-label text-white-50">YouTube URL</label>
              <input type="url" class="form-control form-control-lg" id="video_url" name="video_url"
                placeholder="https://www.youtube.com/watch?v=..." required>
            </div>
            <div class="col-12">
              <label for="prompt" class="form-label text-white-50">Prompt (optional)</label>
              <input type="text" class="form-control" id="prompt" name="prompt"
                placeholder="Names, acronyms, or context to help accuracy">
            </div>
            <div class="col-12 d-grid d-md-flex justify-content-md-end">
              <button type="submit" class="btn btn-primary btn-lg px-4">Transcribe Video</button>
            </div>
          </form>
        </div>
      </div>

      {% if transcription %}
      <section class="results mt-5">
        <div class="card border-0 shadow-sm">
          <div class="card-body">
            <div class="d-flex align-items-center mb-3">
              <span class="badge text-bg-dark me-2">Result</span>
              <span class="text-muted small">{{ video_url }}</span>
            </div>
            <p class="lead">{{ transcription }}</p>

            {% if segments %}
            <hr>
            <h5 class="mb-3">Segments</h5>
            <div class="list-group list-group-flush">
              {% for segment in segments %}
              <div class="list-group-item">
                <small class="text-muted">{{ segment.start | default(0) }}s → {{ segment.end | default(0) }}s</small>
                <p class="mb-0">{{ segment.text }}</p>
              </div>
              {% endfor %}
            </div>
            {% endif %}
          </div>
        </div>
      </section>
      {% endif %}
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>

